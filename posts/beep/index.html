<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Hack The Box - Beep :: Forest Hex ‚Äî Explore Hacking</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description"
  content="Welcome to another Forest Hex hacking adventure! üå≤üèπ Today&amp;rsquo;s plan is to explore a retired CTF from http://hackthebox.eu named &amp;ldquo;Beep&amp;rdquo;. I chose this box because it&amp;rsquo;s easy, it&amp;rsquo;s linux, and it&amp;rsquo;s rated very highly. All that put together should add up to some serious fun, so let&amp;rsquo;s get started:
 Port Scan The first thing, as always, is a port scan:
#!/bin/bash ports=$(nmap -p- --min-rate=1000 -T4 $1 | grep ^[0-9] | cut -d &#39;/&#39; -f 1 | tr &#39;\n&#39; &#39;,&#39; | sed s/,$//) nmap -sC -sV -p$ports $1  Using my bash script (which was taken from an HTB official writeup) we can ensure every port is checked, and that a deeper scan is only performed on open ports." />
<meta name="keywords"
  content="hacking, " />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/posts/beep/" />


<link rel="stylesheet" href="/assets/style.css">

<link rel="stylesheet" href="/assets/green.css">



<link rel="stylesheet" href="/style.css">


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-148164972-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'UA-148164972-1');
</script>



<link rel="apple-touch-icon-precomposed" sizes="144x144"
  href="/img/apple-touch-icon-144-precomposed.png">

<link rel="shortcut icon" href="/images/terrain-forest.png">



<meta name="twitter:card" content="summary" />
<meta name="twitter:title"
  content="Hack The Box - Beep :: Forest Hex ‚Äî Explore Hacking" />
<meta name="twitter:description"
  content="Welcome to another Forest Hex hacking adventure! üå≤üèπ Today&amp;rsquo;s plan is to explore a retired CTF from http://hackthebox.eu named &amp;ldquo;Beep&amp;rdquo;. I chose this box because it&amp;rsquo;s easy, it&amp;rsquo;s linux, and it&amp;rsquo;s rated very highly. All that put together should add up to some serious fun, so let&amp;rsquo;s get started:
 Port Scan The first thing, as always, is a port scan:
#!/bin/bash ports=$(nmap -p- --min-rate=1000 -T4 $1 | grep ^[0-9] | cut -d &#39;/&#39; -f 1 | tr &#39;\n&#39; &#39;,&#39; | sed s/,$//) nmap -sC -sV -p$ports $1  Using my bash script (which was taken from an HTB official writeup) we can ensure every port is checked, and that a deeper scan is only performed on open ports." />
<meta name="twitter:site" content="/" />
<meta name="twitter:creator" content="jivex5k" />
<meta name="twitter:image" content="">


<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title"
  content="Hack The Box - Beep :: Forest Hex ‚Äî Explore Hacking">
<meta property="og:description"
  content="Welcome to another Forest Hex hacking adventure! üå≤üèπ Today&amp;rsquo;s plan is to explore a retired CTF from http://hackthebox.eu named &amp;ldquo;Beep&amp;rdquo;. I chose this box because it&amp;rsquo;s easy, it&amp;rsquo;s linux, and it&amp;rsquo;s rated very highly. All that put together should add up to some serious fun, so let&amp;rsquo;s get started:
 Port Scan The first thing, as always, is a port scan:
#!/bin/bash ports=$(nmap -p- --min-rate=1000 -T4 $1 | grep ^[0-9] | cut -d &#39;/&#39; -f 1 | tr &#39;\n&#39; &#39;,&#39; | sed s/,$//) nmap -sC -sV -p$ports $1  Using my bash script (which was taken from an HTB official writeup) we can ensure every port is checked, and that a deeper scan is only performed on open ports." />
<meta property="og:url" content="/posts/beep/" />
<meta property="og:site_name" content="Hack The Box - Beep" />
<meta property="og:image" content="">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


<meta property="article:published_time" content="2019-10-13 00:00:00 &#43;0000 UTC" />










</head>
<body class="">


<div class="container center">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Forest Hex
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="/posts/beep/">Hack The Box - Beep</a></h1>
  <div class="post-meta">
    
    <span class="post-date">
      2019-10-13
    </span>
    
    
    <span class="post-author">::
      jivex5k
    </span>
    
  </div>

  
  <span class="post-tags">
    tags:
    
    #<a href="/tags/ctf/">ctf</a>&nbsp;
    
    #<a href="/tags/pentesting/">pentesting</a>&nbsp;
    
    #<a href="/tags/htb/">htb</a>&nbsp;
    
    #<a href="/tags/kali/">kali</a>&nbsp;
    
  </span>
  

  

  <div class="post-content">
    

<h3 id="welcome-to-another-forest-hex-hacking-adventure">Welcome to another Forest Hex hacking adventure! üå≤üèπ</h3>

<p>Today&rsquo;s plan is to explore a retired CTF from <a href="http://hackthebox.eu">http://hackthebox.eu</a> named &ldquo;Beep&rdquo;. I chose this box because it&rsquo;s easy, it&rsquo;s linux, and it&rsquo;s rated very highly. All that put together should add up to some serious fun, so let&rsquo;s get started:</p>


  <figure class="left" >
    <img src="../2019-10-13-18-43-45.png"   />
    
  </figure>



<hr />

<h1 id="port-scan">Port Scan</h1>

<p>The first thing, as always, is a port scan:</p>

<pre><code class="language-bash">#!/bin/bash
ports=$(nmap -p- --min-rate=1000 -T4 $1 | grep ^[0-9] | cut -d '/' -f 1 | tr '\n' ',' | sed s/,$//)  
nmap -sC -sV -p$ports $1
</code></pre>

<p>Using my bash script (which was taken from an HTB official writeup) we can ensure every port is checked, and that a deeper scan is only performed on open ports.</p>

<p>
  <figure class="left" >
    <img src="../2019-10-13-19-29-54.png"   />
    
      <figcaption class="center" >Adding beep.htb to /etc/hosts</figcaption>
    
  </figure>



  <figure class="left" >
    <img src="../2019-10-13-19-53-19.png"   />
    
      <figcaption class="center" >Nmap Results</figcaption>
    
  </figure>

</p>


  <figure class="left" >
    <img src="../dino.gif"   />
    
  </figure>



<p>That&rsquo;s a ton of stuff, let&rsquo;s save the output in Cherry Tree and start digging. First let&rsquo;s check out the website.

  <figure class="left" >
    <img src="../2019-10-13-20-23-24.png"   />
    
      <figcaption class="center" >Login Portal</figcaption>
    
  </figure>

</p>

<p>Ah, some kind of login called elastix. I looked up some default logins but none of them worked, ah well, I&rsquo;ll take some notes and move on.</p>

<hr />

<h2 id="poking-around-the-mysql-server">Poking around the mySql Server</h2>

<p>There&rsquo;s a mySql server running on port 3306, so I attempted to login with no password:

  <figure class="left" >
    <img src="../2019-10-13-20-56-05.png"   />
    
      <figcaption class="center" >Trying to login to mySql</figcaption>
    
  </figure>

</p>

<p>No luck, and from the error it sounds like it&rsquo;s a dead end until we have a shell.</p>

<hr />

<h2 id="checking-out-webmin">Checking out Webmin</h2>

<p>There&rsquo;s a server running on port 10000 which nmap identified as Webmin. Sure enough navigating there brought me to a login page. I decided to try several default logins, and after a bit, well&hellip;

  <figure class="left" >
    <img src="../2019-10-13-21-06-43.png"   />
    
  </figure>

</p>

<p>Maybe there&rsquo;s an exploit for it we can use. We have the version number from nmap: MiniServ 1.570</p>


  <figure class="left" >
    <img src="../2019-10-13-21-09-16.png"   />
    
      <figcaption class="center" >Webmin Exploits</figcaption>
    
  </figure>



<p>There&rsquo;s a couple, namely the RCE ones, but the one that doesn&rsquo;t require user auth isn&rsquo;t for our version unfortunately. Onward to explore other services!</p>

<hr />

<h2 id="hylafax-what-are-you-hiding">Hylafax, what are you hiding?</h2>

<p>Hylafax sounds interesting, let&rsquo;s do some digging with searchsploit:

  <figure class="left" >
    <img src="../2019-10-13-21-21-09.png"   />
    
      <figcaption class="center" >Hylafax Exploits</figcaption>
    
  </figure>

</p>

<p>Damn, nothing for version 4.3.1, ah well that&rsquo;s the breaks. Time to keep searching.</p>

<hr />

<h2 id="back-to-elastix">Back to Elastix</h2>

<p>I realized I had not looked at any elastix exploits yet, time to rectify that.</p>


  <figure class="left" >
    <img src="../2019-10-13-21-42-57.png"   />
    
  </figure>



<p>The Blind SQL Injection, and PHP Code Injection both look pretty interesting. I went for the php code injection first, but the exploit itself is in PHP which made it harder for me to understand. After messing around with it for a bit I decided to switch tactics and go for SQL injection.</p>

<p>It looked simple enough to understand, a timing attack on a URL, however I couldn&rsquo;t get any response out of the server using them.
I decided to keep checking Elastix exploits and went with the local file inclusion exploit next.</p>

<p>Checking out the exploit we can see it just crafts a URL:
<code>/vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&amp;module=Accounts&amp;action</code></p>

<p>To quickly test this exploit I simply pasted it after the URL:

  <figure class="left" >
    <img src="../2019-10-13-22-12-09.png"   />
    
      <figcaption class="center" >A local file from the webserver.</figcaption>
    
  </figure>

</p>

<p>Paydirt&hellip; We have a local config file, and from the look of it a lot of passwords. I also noticed it mentioned FreePBX, which one exploit that was listed earlier has as a requirement. I played around with this exploit for a while but couldn&rsquo;t get it to work. I suspect perl isn&rsquo;t available on the remote system.</p>

<p>I decided to look at some of the username and passwords in the config file and noticed a lot of reuse. I decided to try my luck against root ssh, and the second one I tried worked.</p>

<p>amp109
jEhdIekWmdjE - This was it, it&rsquo;s all over the config file.</p>


  <figure class="left" >
    <img src="../2019-10-13-23-28-32.png"   />
    
      <figcaption class="center" >Root and User Flag</figcaption>
    
  </figure>



<hr />

<p>Until next time, this is jivex5k signing off.</p>

  </div>
  <br>

  
  <span class="post-tags">
    tags:
    
    #<a href="/tags/ctf/">ctf</a>&nbsp;
    
    #<a href="/tags/pentesting/">pentesting</a>&nbsp;
    
    #<a href="/tags/htb/">htb</a>&nbsp;
    
    #<a href="/tags/kali/">kali</a>&nbsp;
    
  </span>
  


  
  <div class="pagination">
    <div class="pagination__title">
      <span class="pagination__title-h">Read other posts</span>
      <hr />
    </div>
    <div class="pagination__buttons">
      
      
      <span class="button next">
        <a href="/posts/buffer-overflow-on-arm-controlling-the-return-address/">
          <span class="button__text">Buffer Overflow on ARM #2</span>
          <span class="button__icon">‚Üí</span>
        </a>
      </span>
      
    </div>
  </div>
  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
    <div class="copyright copyright--user">
      <span>Forest Hex 2019</span>
      

      </div>
    </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>




  
</div>

</body>
</html>
